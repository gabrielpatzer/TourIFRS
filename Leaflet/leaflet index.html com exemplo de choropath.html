<!DOCTYPE html>
<html style = "height: 100%; margin: 0;">
  
    <head>
    <title>TourIFRS</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    
    <style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
            position: absolute; top: 0; bottom: 0; left: 0; right: 0;
        }
        .leaflet-tile,
        .leaflet-marker-icon,
        .leaflet-marker-shadow {
            width: 5px;
            height: 8px;
        }
    </style>
      
    </head>
    
  <body style = "height: 100%; margin: 0;">
    <div id="map" style="height:100%; width: 100%; background: FFFFFF"></div>
   
    <script type="text/javascript">
        
        var mapSW = [0, 4096],
            mapNE = [4096, 0];
        
        var map = L.map('map').setView([0,0],1);
        
        L.tileLayer('imagens/{z}/{x}/{y}.png', {
        minZoom: 1,
        maxZoom: 4,
        continuousWorld: false,
        noWrap: true,
        crs: L.CRS.Simple,
        }).addTo(map);
        
        map.setMaxBounds(new L.LatLngBounds(
           map.unproject(mapSW, map.getMaxZoom()), map.unproject(mapNE, map.getMaxZoom()) 
        ));
        
        var marcador = L.icon ({
            iconURL: 'images/marker-icon-2x.png',
            iconSize: [20, 30],
            iconAnchor: [22, 98],
            popupAnchor: [0, 100]
});
            
            
        
        
        //Marcador usado para pegar posição em Pixels
        var ref = L.marker([0,0], {
            draggable: true,
        }).addTo(map);
        ref.bindPopup('');
                
        ref.on ('dragend', function (e) {
           // ref.getPopup().setContent('Clicked' + ref.getLatLng().toString()+'br/>'+ 'Pixels' + map.project(ref.getLatLng(), map.getMaxZoom().toString())) .openOn(map); 
			latlng = ref.getLatLng().toString().split(',')
	        lat = latlng[0]
	        lng = latlng[1]
	        rslt = "["+lng.split(')')[0]+","+lat.split('(')[1]+"]";
           ref.getPopup().setContent(rslt).openOn(map)
        });
        
        
        
        //Marcadores usados para mostrar setores no mapa
        /*
        var hudsh = L.marker(map.unproject([1152, 2904], map.getMaxZoom(),{icon:marcador})).addTo(map);
        hudsh.bindPopup('Administração').openPopup();
        
        var central = L.marker(map.unproject([2568, 3004], map.getMaxZoom(),{icon:marcador})).addTo(map);
        central.bindPopup('Prédio Central').openPopup();
        
        var ti = 
        L.marker(map.unproject([2752, 2852], map.getMaxZoom(),{icon:marcador})).addTo(map);
        ti.bindPopup('Tecnologia da Informação').openPopup(); 
      
        var portico = L.marker(map.unproject([2498, 3263], map.getMaxZoom(),{icon:marcador})).addTo(map);
        portico.bindPopup('Pórtico').openPopup(); 
        */

        // features do GEOjson

        var estruturas = [{
		    "type": "Feature",
		    "properties": {"nome": "Prédio Administrativo",
							"url": "http://www.google.com"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
		        				[29.44,-69.38],
		        				[30.7,-71.7],
		        				[37.4,-71.5],
		        				[37.08,-69.28]
		        				]]
		    }
		},
		
		{
		    "type": "Feature",
		    "properties": {"nome": "Açude",
							"url": "#na-mesma-pagina"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
		        				[-0.878906,-34.741612],
		        				[0.351563,-40.979898],
		        				[17.753906,-39.909736],
		        				[26.894531,-43.068888],
		        				[34.453125,-41.112469],
		        				[36.035156,-37.857507],
		        				[35.507813,-35.88905],
		        				[30.058594,-33.28462],
		        				[15.46875,-35.603719],
		        				[4.570313,-33.870416]
		        				]]
		    },
		},
		
		{
		    "type": "Feature",
		    "properties": {"nome": "Pórtico",
							"url": "#na-mesma-pagina"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
		        				[41.396484,-72.633374],
		        				[41.835938,-72.127936],
		        				[35.947266,-72.019729],
		        				[36.298828,-72.501722]
		        				]]
		    },
		},
		
		{
		    "type": "Feature",
		    "properties": {"nome": "Prédio Central",
							"url": "#na-mesma-pagina"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[42.539063,-60.457218],
								[54.667969,-59.712097],
								[56.337891,-66.791909],
								[45,-67.407487]
								]]
			},
		},
		
		{
		    "type": "Feature",
		    "properties": {"nome": "Prédio A13",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
		        				[26.015625,-68.911005],
		        				[23.730469,-62.390369],
		        				[16.699219,-62.915233],
		        				[18.369141,-69.287257]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Prédio A14",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[8.173828,-63.391522],
		        				[9.667969,-69.718107],
		        				[17.578125,-69.31832],
		        				[ 16.083984,-62.875188]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Ginásio de esportes",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[30.146484,-56.267761],
		        				[31.113281,-59.265881],
		        				[38.847656,-58.7682],
		        				[37.880859,-55.776573]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Restaurante",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[53.789063,-53.225768],
		        				[54.228516,-55.72711],
		        				[43.681641,-56.267761],
		        				[43.330078,-53.696706]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Quadras poliesportivas",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[32.519531,-59.977005],
		        				[34.189453,-66.443107],
		        				[39.375,-66.231457],
		        				[37.617188,-59.623325]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Almoxarifado",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[59.238281,-62.512318],
		        				[59.853516,-65.58572],
		        				[63.720703,-65.476508],
		        				[63.105469,-62.308794]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Ambulatório",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[64.423828,-63.035039],
		        				[66.181641,-62.915233],
		        				[65.917969,-61.100789],
		        				[64.160156,-61.143235]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Prédio Biologia",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[59.677734,-59.623325],
		        				[59.765625,-61.270233],
		        				[65.390625,-61.100789],
								[65.039063,-59.445075]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Prédio Tecnologia da Informação",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[58.974609,-56.897004],
		        				[59.501953,-58.7682],
		        				[65.039063,-58.585436],
								[64.423828,-56.848972]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Coopera",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[63.193359,-50.176898],
		        				[67.236328,-49.95122],
		        				[67.412109,-53.173119],
								[63.632813,-53.173119]
		        				]]
		    },
		},

		{
		    "type": "Feature",
		    "properties": {"nome": "Academia",
							"url": "index.html#pred-a14"},
		    "geometry": {
		        "type": "Polygon",
		        "coordinates": [[
								[26.455078,-53.540307],
		        				[28.652344,-53.696706],
		        				[29.179688,-54.826008],
								[27.861328,-55.627996],
								[25.664063,-55.229023],
								[25.400391,-54.265224]
		        				]]
		    },
		},



		];

		var myStyle = {
		    "color": "#000000",
		    "weight": 2,
		    "opacity": 0.85	
		};

		function resetHighlight(e) {
		    geojson.resetStyle(e.target);
		}
		function highlightFeature(e) {
		    var layer = e.target;

		    layer.setStyle({
		        weight: 5,
		        color: '8f6673',
		        dashArray: '',
		        fillOpacity: 0.7
		    });

		    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
		        layer.bringToFront();
		    }
		}
		function onEachFeature(feature, layer) {
		    layer.on({
		        mouseover: highlightFeature,
		        mouseout: resetHighlight
		    });
		    if (feature.properties && feature.properties.nome) {
		        layer.bindPopup("<a href=\""+feature.properties.url+"\">"+feature.properties.nome+"</a>");
    }
		}

		geojson = L.geoJson(estruturas, {
		    style: myStyle,
		    onEachFeature: onEachFeature
		}).addTo(map);      
    </script>
  </body>
    
</html>